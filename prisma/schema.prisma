generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model user {
  id            String      @id @db.VarChar(16)
  username      String      @db.VarChar(100)
  email         String      @db.VarChar(100)
  password      String      @db.VarChar(100)
  emailVerified Boolean
  roleID        String      @db.VarChar(16)
  race          String      @db.VarChar(100)
  money         Int?
  createdAt     DateTime    @default(now()) @db.DateTime(0)
  updatedAt     DateTime    @default(now()) @updatedAt @db.DateTime(0)
  comment       comment[]
  error_log     error_log[]
  media         media[]
  post          post[]
  savegames     savegames[]
  session       session[]
  roles         roles       @relation(fields: [roleID], references: [id], onDelete: Cascade, map: "user_roles_FK")

  @@index([roleID], map: "user_roles_FK")
}

model savegames {
  id         String   @id @db.VarChar(100)
  userID     String   @db.VarChar(16)
  filename   String   @db.VarChar(100)
  uploadedAt DateTime @default(now()) @db.DateTime(0)
  user       user     @relation(fields: [userID], references: [id], onDelete: Cascade, map: "savegames_user_FK")

  @@index([userID], map: "savegames_user_FK")
}

model session {
  id          String    @id @db.VarChar(16)
  userID      String    @db.VarChar(16)
  sessionData String    @db.VarChar(500)
  loginAt     DateTime  @default(now()) @db.DateTime(0)
  logoutAt    DateTime? @db.DateTime(0)
  status      String    @db.VarChar(50)
  user        user      @relation(fields: [userID], references: [id], onDelete: Cascade, map: "session_user_FK")

  @@index([userID], map: "session_user_FK")
}

model comment {
  id                        String   @id @db.VarChar(16)
  content                   String   @db.LongText
  author                    String   @db.VarChar(100)
  authorID                  String   @db.VarChar(16)
  postID                    String   @db.VarChar(16)
  createdAt                 DateTime @default(now()) @db.DateTime(0)
  updatedAt                 DateTime @default(now()) @db.DateTime(0)
  post_comment_postIDTopost post     @relation("comment_postIDTopost", fields: [postID], references: [id], onDelete: Cascade, map: "comment_post_FK")
  user                      user     @relation(fields: [authorID], references: [id], onDelete: Cascade, map: "comment_user_FK")

  @@index([postID], map: "comment_post_FK")
  @@index([authorID], map: "comment_user_FK")
}

model post {
  id                           String    @id @db.VarChar(16)
  title                        String    @db.VarChar(100)
  content                      String    @db.LongText
  author                       String    @db.VarChar(100)
  authorID                     String    @db.VarChar(16)
  published                    Boolean   @default(false)
  draft                        Boolean   @default(true)
  createdAt                    DateTime  @default(now()) @db.DateTime(0)
  updatedAt                    DateTime  @default(now()) @db.DateTime(0)
  comment_comment_postIDTopost comment[] @relation("comment_postIDTopost")
  user                         user      @relation(fields: [authorID], references: [id], onDelete: Cascade, map: "post_user_FK")

  @@index([authorID], map: "post_user_FK")
}

model error_log {
  id         String   @id @db.VarChar(16)
  userID     String   @db.VarChar(16)
  errortype  String   @db.VarChar(200)
  failedData String   @db.VarChar(1200)
  createdAt  DateTime @default(now()) @db.Timestamp(0)
  user       user     @relation(fields: [userID], references: [id], onDelete: Cascade, map: "failedlogin_user_FK")

  @@index([userID], map: "failedlogin_user_FK")
}

model media {
  id         String   @id @db.VarChar(16)
  filename   String   @db.VarChar(100)
  type       String   @db.VarChar(100)
  uploadedBy String   @db.VarChar(100)
  uploadedAt DateTime @default(now()) @db.Timestamp(0)
  user       user     @relation(fields: [uploadedBy], references: [id], onDelete: Cascade, map: "media_user_FK")

  @@index([uploadedBy], map: "media_user_FK")
}

model permissions {
  id               String             @id @db.VarChar(16)
  name             String             @db.VarChar(100)
  description      String             @db.VarChar(200)
  createdAt        DateTime           @default(now()) @db.Timestamp(0)
  updatedAt        DateTime           @default(now()) @db.Timestamp(0)
  role_permissions role_permissions[]
}

model role_permissions {
  permissionID String      @db.VarChar(16)
  roleID       String      @db.VarChar(16)
  permissions  permissions @relation(fields: [permissionID], references: [id], onDelete: Cascade, map: "role_permissions_permissions_FK")
  roles        roles       @relation(fields: [roleID], references: [id], onDelete: Cascade, map: "role_permissions_roles_FK")

  @@id([roleID, permissionID])
  @@index([permissionID], map: "role_permissions_permissions_FK")
}

model roles {
  id               String             @id @db.VarChar(16)
  name             String             @db.VarChar(100)
  description      String?            @db.VarChar(200)
  createdAt        DateTime           @default(now()) @db.Timestamp(0)
  updatedAt        DateTime           @default(now()) @db.Timestamp(0)
  role_permissions role_permissions[]
  user             user[]
}
